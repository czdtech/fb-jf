---
import gamesList from '@/data/games-list.json'
import GamePageLayout from '@/layouts/GamePageLayout.astro'

export async function getStaticPaths() {
  // 从所有分类中收集游戏
  const allGames = [
    ...gamesList.categories.popular,
    ...gamesList.categories.new,
    ...gamesList.categories.trending,
  ]

  // 生成路径参数
  return allGames.map(game => ({
    params: { slug: game.slug },
    props: { gameData: game },
  }))
}

const { gameData } = Astro.props

// 转换数据格式以适配GamePageLayout
const layoutProps = {
  meta: gameData.meta,
  gameData: {
    title: gameData.title,
    description: gameData.description,
    iframe: gameData.iframe,
    backgroundImage: gameData.image,
    // 可选：添加评分和特色功能（如果JSON中有的话）
    rating: (gameData as any).rating || undefined,
    features: (gameData as any).features || undefined,
    howToPlay: (gameData as any).howToPlay || undefined,
  },
  aboutContent: (gameData as any).aboutContent || undefined,
}
---

<GamePageLayout {...layoutProps} />
