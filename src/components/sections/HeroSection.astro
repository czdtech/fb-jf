---
interface Props {
  hero: {
    title: string
    description: string
    mainGame: {
      iframe: string
      backgroundImage: string
    }
  }
  games: {
    new: any[]
    popular: any[]
    trending: any[]
  }
}

const { hero, games } = Astro.props

// 导入组件
import GameCard from '@/components/GameCard.astro'
import GameIframe from '@/components/GameIframe.astro'
import HeroHeader from '@/components/sections/HeroHeader.astro'
import HeroGamesSidebar from '@/components/sections/HeroGamesSidebar.astro'
import HeroCommunityGames from '@/components/sections/HeroCommunityGames.astro'
import HeroTrendingGames from '@/components/sections/HeroTrendingGames.astro'
import HeroMainGame from '@/components/sections/HeroMainGame.astro'

// Community Mods游戏数据
const communityMods = [
  {
    title: 'Fiddlebops but Sprunki',
    slug: 'fiddlebops-but-sprunki',
    image: '/fiddlebops-but-sprunki.png',
  },
  {
    title: 'Fiddlebops Fix',
    slug: 'fiddlebops-fix',
    image: '/fiddlebops-fix.png',
  },
  {
    title: 'Fiddlebops Polos',
    slug: 'fiddlebops-polos',
    image: '/fiddlebops-polos.png',
  },
  {
    title: "Fiddlebops But Dandy's World",
    slug: 'fiddlebops-but-dandys-world',
    image: '/fiddlebops-but-dandys-world.png',
  },
]
---

<!-- Hero Section: 重构后的组件化设计 -->
<section class="hero-section scroll-animate">
  <div class="container">
    <!-- Hero Content: 简洁游戏化设计 -->
    <HeroHeader title={hero.title} description={hero.description} />

    <!-- Three Column Layout: New Games | Main Game | Popular Games -->
    <div class="hero-section__games">
      <!-- Left Column - New Games -->
      <HeroGamesSidebar
        title="✨ New Games"
        games={games.new}
        variant="left"
        musicDelayStart={1}
      />

      <!-- Center Column - Main Game Area with Community Games -->
      <div class="hero-section__main-game-area">
        <!-- Main Game iframe -->
        <HeroMainGame
          mainGame={hero.mainGame}
          musicDelay={3}
        />

        <!-- Community Games - Directly below iframe -->
        <HeroCommunityGames
          communityMods={communityMods}
          musicDelayStart={7}
        />
      </div>

      <!-- Right Column - Popular Games -->
      <HeroGamesSidebar
        title="🔥 Popular Games"
        games={games.popular}
        variant="right"
        musicDelayStart={2}
      />
    </div>


    <!-- Trending Games Section -->
    <HeroTrendingGames
      games={games.trending}
      musicDelayStart={10}
    />
  </div>
</section>

<script>
  // 简化的音符动画交互效果
  document.addEventListener('DOMContentLoaded', function () {
    const musicElements = document.querySelectorAll('.music-element')

    // 保留鼠标悬停的音符动画增强
    musicElements.forEach(element => {
      element.addEventListener('mouseenter', function (this: HTMLElement) {
        this.classList.add('hero-music-pulse-hover')
      })

      element.addEventListener('mouseleave', function (this: HTMLElement) {
        this.classList.remove('hero-music-pulse-hover')
      })
    })
  })
</script>

<style>
  /**
 * HeroSection Component
 *
 * 背景层级：
 * 1. 主背景渐变 (.hero-section)
 * 2. 装饰纹理 (.hero-section::before)
 * 3. 侧边栏玻璃效果 (.hero-section__sidebar-content)
 * 4. 主要内容背景 (.hero-section__main-game)
 *
 * 使用的设计令牌：
 * - --hero-main-bg: 主背景渐变
 * - --hero-texture-bg: 点状纹理
 * - --hero-sidebar-glass-*: 玻璃拟态效果
 */

  /* ==========================================================================
   Hero Section - 组件化设计
   ========================================================================== */

  .hero-section {
    /* 使用页面级背景，只需要设置布局和间距 */
    padding-top: calc(80px + var(--space-8));
    padding-bottom: var(--space-8);
    min-height: 85vh;
    display: flex;
    align-items: center;
  }

  .hero-section__games {
    /* 游戏区域布局 */
    display: grid;
    grid-template-columns: 250px 1fr 250px;
    gap: var(--space-4);
    align-items: start;
    max-width: 100%;
    margin: 0 auto;
    flex: 1;
    min-height: 0;
  }


  /* ==========================================================================
   响应式设计
   ========================================================================== */

  @media (min-width: 1400px) {
    .hero-section__games {
      grid-template-columns: 280px 1fr 280px;
      gap: var(--space-6);
    }
  }

  @media (max-width: 1200px) {
    .hero-section__games {
      grid-template-columns: 220px 1fr 220px;
      gap: var(--space-3);
    }
  }

  @media (max-width: 1024px) {
    .hero-section__games {
      grid-template-columns: 1fr;
      gap: var(--space-4);
    }

    .hero-section__main-game-area {
      order: 0;
      width: 100%;
    }
  }

  @media (max-width: 768px) {
    .hero-section {
      padding-top: calc(80px + var(--space-4));
      padding-bottom: var(--space-8);
    }
  }

  @media (max-width: 480px) {
    .hero-section {
      padding-top: calc(80px + var(--space-2));
      padding-bottom: var(--space-6);
    }
  }



  /* ==========================================================================
   Main Game Area Styles
   ========================================================================== */

  .hero-section__main-game-area {
    /* 主游戏区域容器，包含游戏iframe和社区游戏 */
    display: flex;
    flex-direction: column;
    gap: var(--space-5);
    height: 100%;
    min-height: 800px;
  }

  /* ==========================================================================
   响应式设计
   ========================================================================== */
</style>
