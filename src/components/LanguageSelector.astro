---
import LanguageSelectorNative from './LanguageSelectorNative.astro'

interface Props {
  currentPath?: string
  className?: string
}

const { currentPath = '', className = '' } = Astro.props

// Detect current language from URL path
const url = new URL(Astro.request.url)
const pathSegments = url.pathname.split('/').filter(Boolean)
const currentLang = pathSegments[0] && ['zh', 'es', 'fr', 'de', 'ja', 'ko'].includes(pathSegments[0]) 
  ? pathSegments[0] 
  : 'en'

// Get the current page path without language prefix
const currentPagePath = currentLang === 'en' 
  ? url.pathname 
  : url.pathname.replace(`/${currentLang}`, '') || '/'

// Language configuration with proper labels and paths
const languages = [
  { code: 'en', label: 'English', path: currentPagePath === '/' ? '/' : currentPagePath },
  { code: 'zh', label: '简体中文', path: `/zh${currentPagePath}` },
  { code: 'es', label: 'Español', path: `/es${currentPagePath}` },
  { code: 'fr', label: 'Français', path: `/fr${currentPagePath}` },
  { code: 'de', label: 'Deutsch', path: `/de${currentPagePath}` },
  { code: 'ja', label: '日本語', path: `/ja${currentPagePath}` },
  { code: 'ko', label: '한국어', path: `/ko${currentPagePath}` }
]
---

<div class={`language-selector ${className}`}>
  <LanguageSelectorNative 
    currentLang={currentLang}
    languages={languages}
  />
</div>