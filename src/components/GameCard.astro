---
import { Image } from 'astro:assets';

interface Props {
  title: string;
  thumbnail: string;
  slug: string;
  description?: string;
  loading?: 'lazy' | 'eager';
  lang?: string;
}

const { title, thumbnail, slug, description, loading = 'lazy', lang = 'en' } = Astro.props;

const LANGUAGE_PREFIXES: Record<string, string> = {
  'en': '',
  'zh-CN': '/zh',
  'es': '/es',
  'fr': '/fr',
  'de': '/de',
  'ja': '/ja',
  'ko': '/ko'
};

const prefix = LANGUAGE_PREFIXES[lang] ?? '';
const href = `${prefix}/${slug}/`;

// Determine if thumbnail is a local or remote image
const isRemote = thumbnail.startsWith('http://') || thumbnail.startsWith('https://');
const isAbsolutePath = thumbnail.startsWith('/');

// For local images, we need to handle them differently
// Remote images and absolute paths (public folder) can be used directly
---

<div class="game game--compact">
  <a href={href} title={title}>
    <div class="game-logo game-l-2">
      {isRemote || isAbsolutePath ? (
        <img 
          src={thumbnail} 
          alt={title} 
          loading={loading}
          width="300"
          height="300"
        />
      ) : (
        <Image 
          src={thumbnail} 
          alt={title} 
          loading={loading}
          width={300}
          height={300}
          format="webp"
        />
      )}
      <div class="game-overlay">
        <p>{title}</p>
      </div>
    </div>
  </a>
</div>
