---
export interface Props {
  id?: string;
  src?: string;
  backgroundImage?: string;
  autoLoad?: boolean;
}

const {
  id = "Fiddlebops-iframe",
  src = "",
  backgroundImage = "/tw.jpg",
  autoLoad = false
} = Astro.props;
---

<div class="game-iframe-sprunki" style={`background-image: url(${backgroundImage})`}>
  <div class="game-overlay"></div>
  <iframe
    id={id}
    src={autoLoad ? src : ""}
    allowtransparency="true"
    frameborder="0"
    scrolling="no"
    allowfullscreen
    width="100%"
    height="100%"
  ></iframe>
  {!autoLoad && <button id="playButton">Play</button>}
</div>

{!autoLoad && (
  <script define:vars={{ iframeId: id, iframeSrc: src }}>
    let iframeLoaded = false;
    const iframe = document.getElementById(iframeId);
    const playButton = document.getElementById("playButton");

    function loadIframe() {
      if (!iframeLoaded) {
        iframe.src = iframeSrc;
        playButton.style.display = "none";
        iframeLoaded = true;
        iframe.focus();
      }
    }

    playButton?.addEventListener("click", loadIframe);
  </script>
)}

<style>
.game-iframe-sprunki {
  width: 100%;
  height: 100%;
  margin: 0;
  padding: 0;
  background-color: #fff;
  position: relative;
  background-repeat: no-repeat;
  background-position: center center;
  background-size: cover;
  overflow: hidden;
}

.game-overlay {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(
    135deg,
    rgba(248, 250, 252, 0.45) 0%,
    rgba(241, 245, 249, 0.45) 25%,
    rgba(226, 232, 240, 0.45) 50%,
    rgba(203, 213, 225, 0.45) 75%,
    rgba(148, 163, 184, 0.45) 100%
  );
  z-index: 1;
  pointer-events: none;
}

#playButton {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: linear-gradient(135deg, #ff6b35 0%, #f7931e 100%);
  color: white;
  padding: 15px 30px;
  font-size: 1.2em;
  border: none;
  border-radius: 12px;
  cursor: pointer;
  z-index: 20;
  transition: all 0.3s ease;
  box-shadow: 0 4px 15px rgba(255, 107, 53, 0.4);
  font-weight: 600;
  letter-spacing: 0.5px;
}

#playButton:hover {
  background: linear-gradient(135deg, #ff5722 0%, #e68900 100%);
  transform: translate(-50%, -50%) scale(1.05);
  box-shadow: 0 6px 20px rgba(255, 107, 53, 0.6);
}

@media screen and (max-width: 980px) {
  .game-iframe-sprunki {
    width: 100%;
  }
}

@media screen and (max-width: 768px) {
  .game-iframe-sprunki {
    max-height: 330px;
  }
}
</style>
